@model PagedList.IPagedList<MSIdentity.Models.Product>
@using PagedList.Mvc;

<link href="~/CSS/PagedList.css" rel="stylesheet" />
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
@Styles.Render("~/CSS/PagedList.css")
<style>
    .table {
        border: 1px solid black;
    }

    td {
        height: 40px;
        
    }
</style>
<script type="text/javascript">
    $(function () {
        $('#myPager').on('click', 'a', function () {
            $.ajax({
                url: this.href,
                type: 'GET',
                cache: false,
                success: function (result) {
                    $('#gridContent').html(result);
                }
            });
            return false;
        });
    });
</script>
@{
    ViewBag.Title = "Products";
}


<div id="main" style="border-style: solid; border-width: 1px; margin-top:20px;">
    <div style="margin-left: 10px;">
        <p>
            @*@Html.ActionLink("Create New", "Create")*@
        </p>
        @using (Ajax.BeginForm("Index", "Product", new AjaxOptions { HttpMethod = "Get", InsertionMode = InsertionMode.Replace, UpdateTargetId = "gridContent" }))
        {

            <p>
                Product Name: @Html.TextBox("SearchString", ViewBag.CurrentFilter as string)
                @Html.DropDownList("CategoryId", (SelectList)ViewBag.Categories, "--Select Category--")
                <input type="submit" value="Search" />
            </p>

        }
    </div>
</div>
<br />
<div style="border-style: solid; border-width: 1px; margin-top:10px;">
    <p style="margin-left: 10px;margin-top: 15px;">Total Number of records: @ViewBag.TotalNoOfRec</p>
    <br />
    <div id="gridContent" style="margin-left: 10px;margin-right: 10px;margin-top: 7px;">
        <table class="table">
            <tr>
                <th>
                    @Ajax.ActionLink("Name", "Index",
                        new { sortOrder = ViewBag.DescriptionSortParm, currentFilter = ViewBag.CurrentFilter },
                        new AjaxOptions

                        {
                            UpdateTargetId = "gridContent", // <-- DOM element ID to update

                            InsertionMode = InsertionMode.Replace, // <-- Replace the content of DOM element

                            HttpMethod = "GET", // <-- HTTP method

                        })


                    @*@Html.ActionLink("Name", "Index", new { sortOrder = ViewBag.NameSortParm, currentFilter = ViewBag.CurrentFilter })*@
                </th>
                <th>
                    @Ajax.ActionLink("Description", "Index",
                        new { sortOrder = ViewBag.DescriptionSortParm, currentFilter = ViewBag.CurrentFilter },
                        new AjaxOptions

                        {
                            UpdateTargetId = "gridContent", // <-- DOM element ID to update

                            InsertionMode = InsertionMode.Replace, // <-- Replace the content of DOM element

                            HttpMethod = "GET", // <-- HTTP method

                        })
                </th>
                <th>
                    @Ajax.ActionLink("Price", "Index",
                        new { sortOrder = ViewBag.PriceSortParm, currentFilter = ViewBag.CurrentFilter },
                        new AjaxOptions

                        {
                            UpdateTargetId = "gridContent", // <-- DOM element ID to update

                            InsertionMode = InsertionMode.Replace, // <-- Replace the content of DOM element

                            HttpMethod = "GET", // <-- HTTP method

                        })
                </th>
                <th></th>
            </tr>


            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.Name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Description)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Price)
                    </td>
                    <td>
                        @*@Html.ActionLink("Edit", "Edit", new { id = item.ID }) |
                            @Html.ActionLink("Details", "Details", new { id = item.ID }) |
                            @Html.ActionLink("Delete", "Delete", new { id = item.ID })*@
                    </td>
                </tr>
            }

        </table>
        <br />
        <div id="myPager">
            <table style="width: 100%;">
                <tr>
                    <td style="width: 10%;">Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount</td>
                    <td style="width: 40%;">
                        @Html.PagedListPager(Model, page => Url.Action("Index",
                            new { page, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter }))
                    </td>
                    <td>
                        @using (Ajax.BeginForm("Index", "Product", new AjaxOptions { HttpMethod = "Get", InsertionMode = InsertionMode.Replace, UpdateTargetId = "gridContent" }))
                        {

                            <p>
                                @Html.TextBox("page", ViewBag.CurrentFilter as string, null, new { style = "width:40px" })
                            </p>

                        }
                    </td>
                </tr>
            </table>
        </div>



    </div>
</div>

@section scripts{

    @Scripts.Render("~/Scripts/jquery-1.10.2.min.js")
    @Scripts.Render("~/Scripts/jquery.unobtrusive-ajax.min.js")


}